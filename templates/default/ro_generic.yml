# Uniwersalny szablon dla rumuńskich faktur
issuer: "Szablon Ogólny Rumuński"
description: "Domyślny szablon dla faktur w języku rumuńskim"
language: "Rumuński"
language_code: "ro"
priority: 1

# ============================================
# SŁOWA KLUCZOWE DO IDENTYFIKACJI DOKUMENTU
# ============================================
keywords:
  - "FACTURA"
  - "FACTURĂ"
  - "CUI"
  - "CIF"
  - "FURNIZOR"
  - "CLIENT"

exclude_keywords: []

# ============================================
# KONFIGURACJA WALUTY
# ============================================
currency:
  default: "RON"
  patterns:
    RON:
      codes: ["RON"]
      symbols: ["lei", "LEI", "leu", "LEU", "Ron"]
      weight: 1.0
    EUR:
      codes: ["EUR"]
      symbols: ["€", "euro", "EURO", "Euro"]
      weight: 0.8
    USD:
      codes: ["USD"]
      symbols: ["$", "dolari", "USD"]
      weight: 0.6
  ignore_patterns:
    - '[A-Z]{2}\d{2}[\s]?[A-Z0-9]{4}[\s]?[\d]{4}[\s]?[\d]{4}[\s]?[\d]{4}[\s]?[\d]{4}'
    - 'RO\s?\d{2,10}'
    - '(?:CUI|CIF|Cod fiscal)[:\s]*(?:RO)?[\s-]?\d{2,10}'

# ============================================
# KONFIGURACJA NUMERU FAKTURY
# ============================================
invoice_number:
  prefixes:
    - 'Factura[_\s-]*(?:nr|numar)?[:\s]*'
    - 'Factură[_\s-]*(?:nr|număr)?[:\s]*'
    - 'Factura\s+fiscala\s+seria\s+'
    - 'Serie\s+si\s+numar[:\s]*'
    - 'Nr\.\s*factura[:\s]*'
    - 'Numar\s+factura[:\s]*'
  patterns:
    - '([A-Z]{1,5}\s+[A-Z]?\s*\d{5,10})'
    - '([A-Z]{1,4}[/\\-]\d{1,6}(?:[/\\-]\d{1,4}){0,2})'
    - '(\d{1,6}[/\\-]\d{2,4}(?:[/\\-]\d{1,4})?)'
    - '(\d{8,15})'
    - '([A-Z]{2,5}\d{5,10})'
  line_keywords:
    - "FACTURA"
    - "FACTURĂ"
  # Specjalne dla rumuńskich faktur z serią
  series_pattern: 'seria\s+([A-Z]{1,5}(?:\s+[A-Z])?)'

# ============================================
# KONFIGURACJA TYPU FAKTURY
# ============================================
invoice_type:
  default: "VAT"
  mapping:
    KOREKTA:
      keywords: ["STORNO", "ANULARE", "CORECTIE", "CORECȚIE"]
    PROFORMA:
      keywords: ["PROFORMA", "PRO FORMA", "PRO-FORMA"]
    ZALICZKOWA:
      keywords: ["AVANS", "FACTURA DE AVANS"]
    KOŃCOWA:
      keywords: ["FINALA", "FINALĂ", "FINAL"]

# ============================================
# KONFIGURACJA TYPU DOKUMENTU (ORYGINAŁ/KOPIA)
# ============================================
document_type:
  default: "nieznany"
  patterns:
    oryginał:
      - '\bORIGINAL\b'
      - '\bORIGINALE\b'
    kopia:
      - '\bCOPIE\b'
      - '\bCOPY\b'
    duplikat:
      - '\bDUPLICAT\b'
      - '\bDUPLICATE\b'

# ============================================
# KONFIGURACJA DAT
# ============================================
dates:
  formats:
    - pattern: '\d{2}\.\d{2}\.\d{4}'
      format: '%d.%m.%Y'
    - pattern: '\d{2}-\d{2}-\d{4}'
      format: '%d-%m-%Y'
    - pattern: '\d{2}/\d{2}/\d{4}'
      format: '%d/%m/%Y'
    - pattern: '\d{4}-\d{2}-\d{2}'
      format: '%Y-%m-%d'
  
  issue_date:
    keywords:
      - "DATA EMITERII"
      - "Data emiterii"
      - "DATA FACTURII"
      - "Data facturii"
      - "EMIS LA"
      - "Emis la"
      - "DATA"
    search_range: 150
    required: true
  
  sale_date:
    keywords:
      - "DATA LIVRĂRII"
      - "Data livrării"
      - "DATA LIVRARII"
      - "DATA PRESTĂRII"
      - "Data prestării"
      - "DATĂ DOSTAWY"
    search_range: 150
    fallback: "use_issue_date"
  
  due_date:
    keywords:
      - "TERMEN DE PLATĂ"
      - "Termen de plată"
      - "SCADENȚĂ"
      - "Scadență"
      - "SCADENTA"
      - "DATA SCADENTĂ"
      - "Plătibil până la"
    search_range: 150
    fallback_days: 14

# ============================================
# KONFIGURACJA CUI/CIF (IDENTYFIKATORÓW PODATKOWYCH)
# ============================================
tax_id:
  name: "CUI/CIF"
  patterns:
    - 'Cod[-\s]?fiscal[:\s]*(?:RO)?\s*(\d{2,10})'
    - '(?:CUI|CIF|C\.I\.F\.)[:\s]*RO\s*(\d{2,10})'
    - '(?:CUI|CIF|C\.I\.F\.)[:\s]*(\d{2,10})'
    - '\bRO\s*(\d{2,10})\b'
    - 'Cod\s+unic\s+de\s+inregistrare[:\s]*(\d{2,10})'
    - 'C\.U\.I\.[:\s]*(\d{2,10})'
    - 'Nr\.\s*inreg\.\s*Reg\.\s*Com\.[:\s]*J\d+/\d+/\d+'
  validation:
    type: "cui_ro"
    min_length: 2
    max_length: 10
  prefix: "RO"

# ============================================
# KONFIGURACJA STRON (SPRZEDAWCA/NABYWCA)
# ============================================
parties:
  seller:
    keywords:
      - "FURNIZOR"
      - "Furnizor"
      - "VÂNZĂTOR"
      - "Vânzător"
      - "PRESTATOR"
      - "Prestator"
      - "EMITENT"
      - "Emitent"
    context_range: 300
  
  buyer:
    keywords:
      - "CLIENT"
      - "Client"
      - "CUMPĂRĂTOR"
      - "Cumpărător"
      - "BENEFICIAR"
      - "Beneficiar"
      - "DESTINATAR"
      - "Destinatar"
    context_range: 300

# ============================================
# KONFIGURACJA ADRESÓW
# ============================================
address:
  patterns:
    - '(\d{6}\s+[A-ZĂÂÎȘȚ][a-zăâîșț]+(?:\s+[A-ZĂÂÎȘȚ][a-zăâîșț]+)*)'
    - '(str\.\s+[A-ZĂÂÎȘȚa-zăâîșț\s]+,?\s*nr\.\s*\d+)'
    - '(jud\.\s+[A-ZĂÂÎȘȚ][a-zăâîșț]+)'
  postal_code_pattern: '\d{6}'
  context_range: 400

# ============================================
# KONFIGURACJA KONT BANKOWYCH
# ============================================
bank_accounts:
  patterns:
    - '(?:RO\s?)?\d{2}\s?[A-Z]{4}\s?[\dA-Z]{4}\s?[\dA-Z]{4}\s?[\dA-Z]{4}\s?[\dA-Z]{4}'
    - 'IBAN[:\s]*([A-Z]{2}\d{2}[A-Z0-9\s]+)'
    - 'RO\d{2}[A-Z]{4}[\dA-Z]{16}'
    - 'Cont[:\s]*([A-Z]{2}\d{2}[A-Z0-9\s]+)'
  iban_prefix: "RO"
  validation: "iban"

# ============================================
# KONFIGURACJA KWOT
# ============================================
amounts:
  decimal_separator: ","
  thousand_separator: "."
  
  total_gross:
    keywords:
      - "TOTAL DE PLATĂ"
      - "Total de plată"
      - "TOTAL"
      - "Total"
      - "SUMA TOTALĂ"
      - "Suma totală"
      - "VALOARE TOTALĂ"
      - "DE PLATĂ"
      - "TOTAL FACTURĂ"
    patterns:
      - '(\d{1,3}(?:\.\d{3})*(?:,\d{2})?)\s*(?:lei|LEI|RON)'
      - '(\d{1,3}(?:\s\d{3})*(?:,\d{2})?)\s*(?:lei|LEI|RON)'
    required: true
  
  total_net:
    keywords:
      - "TOTAL FĂRĂ TVA"
      - "Total fără TVA"
      - "VALOARE FĂRĂ TVA"
      - "BAZA"
      - "Baza"
      - "SUBTOTAL"
    fallback: "calculate_from_gross"
    default_vat_rate: 19
  
  total_vat:
    keywords:
      - "TVA"
      - "T.V.A."
      - "VALOARE TVA"
      - "Valoare TVA"
      - "TAXA PE VALOARE"
    fallback: "calculate_difference"

# ============================================
# KONFIGURACJA PŁATNOŚCI
# ============================================
payment:
  methods:
    przelew:
      keywords: ["TRANSFER", "VIRAMENT", "OP", "ORDIN DE PLATĂ"]
    gotówka:
      keywords: ["NUMERAR", "CASH", "ÎN NUMERAR"]
    karta:
      keywords: ["CARD", "CARTE", "POS"]
    cec:
      keywords: ["CEC", "FILĂ CEC"]
  
  status:
    opłacona:
      keywords: ["ACHITAT", "PLĂTIT", "ÎNCASAT", "PAID"]
    częściowo_opłacona:
      keywords: ["AVANS", "PARȚIAL", "PARTIAL"]
    nieopłacona:
      keywords: ["DE PLATĂ", "NEACHITAT", "RESTANT"]
  
  default_method: "przelew"
  default_status: "nieopłacona"

# ============================================
# KONFIGURACJA POZYCJI FAKTURY
# ============================================
line_items:
  enabled: true
  
  table_start:
    keywords:
      - "NR"
      - "Nr."
      - "CRT"
      - "DENUMIRE"
      - "Denumire"
      - "PRODUS"
    patterns:
      - 'Nr|NR|Crt'
      - 'Denumire.*Cantitate.*Preț'
      - 'Produs.*U\.M\..*Cant'
  
  table_end:
    keywords:
      - "TOTAL"
      - "Total"
      - "SUBTOTAL"
      - "VALOARE"
  
  skip_patterns:
    - 'Pagina \d+ din \d+'
    - '-{3,}'
    - '={3,}'

# ============================================
# OPCJE PARSOWANIA
# ============================================
options:
  normalize_backslash: true
  remove_extra_whitespace: true
  case_insensitive_keywords: true
  date_tolerance_days: 365
  amount_tolerance: 0.02
  tax_id_assignment_strategy: "context_proximity"
  validate_iban: true
  validate_tax_id: true
  debug_mode: false

# ============================================
# METADANE
# ============================================
metadata:
  author: "System"
  version: "2.0"
  created: "2025-11-29"
  updated: "2025-11-29"