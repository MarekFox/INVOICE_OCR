# Uniwersalny szablon dla angielskich faktur
issuer: "Szablon Ogólny Angielski"
description: "Domyślny szablon dla faktur w języku angielskim"
language: "Angielski"
language_code: "en"
priority: 1

# ============================================
# SŁOWA KLUCZOWE DO IDENTYFIKACJI DOKUMENTU
# ============================================
keywords:
  - "INVOICE"
  - "TAX INVOICE"
  - "VAT"
  - "SUPPLIER"
  - "CUSTOMER"
  - "BILL TO"

exclude_keywords: []

# ============================================
# KONFIGURACJA WALUTY
# ============================================
currency:
  default: "EUR"
  patterns:
    EUR:
      codes: ["EUR"]
      symbols: ["€", "euro", "EURO", "Euro"]
      weight: 1.0
    USD:
      codes: ["USD"]
      symbols: ["$", "dollar", "dollars", "US$"]
      weight: 1.0
    GBP:
      codes: ["GBP"]
      symbols: ["£", "pound", "pounds", "sterling"]
      weight: 1.0
    PLN:
      codes: ["PLN"]
      symbols: ["zł", "zloty", "PLN"]
      weight: 0.6
  ignore_patterns:
    - '[A-Z]{2}\d{2}[\s]?[A-Z0-9]{4}[\s]?[\d]{4}[\s]?[\d]{4}[\s]?[\d]{4}[\s]?[\d]{4}'
    - '(?:GB|IE|US)\s?\d{8,12}'
    - '(?:VAT|TAX)[\s-]?(?:ID|No|Number)[:\s]*[A-Z0-9\s]+'

# ============================================
# KONFIGURACJA NUMERU FAKTURY
# ============================================
invoice_number:
  prefixes:
    - 'Invoice[\s]*(?:No|Number|#)?[:\s]*'
    - 'Inv[\s]*(?:No|#)?[:\s]*'
    - 'Invoice\s+ID[:\s]*'
    - 'Bill[\s]*(?:No|Number)?[:\s]*'
    - 'Reference[\s]*(?:No|Number)?[:\s]*'
    - 'Document[\s]*(?:No|Number)?[:\s]*'
  patterns:
    - '([A-Z]{1,4}[/\\-]\d{1,6}(?:[/\\-]\d{1,4}){0,2})'
    - '(\d{1,6}[/\\-]\d{2,4}(?:[/\\-]\d{1,4})?)'
    - '([A-Z]{1,4}[-_]\d{1,6}[-_]\d{2,4})'
    - '(\d{4}[/\\-][A-Z]{1,4}[/\\-]\d{1,6})'
    - '(\d{8,15})'
    - '([A-Z]{2,5}\d{5,10})'
    - '(INV[-_]?\d{4,10})'
  line_keywords:
    - "INVOICE"
    - "BILL"
    - "TAX INVOICE"

# ============================================
# KONFIGURACJA TYPU FAKTURY
# ============================================
invoice_type:
  default: "VAT"
  mapping:
    KOREKTA:
      keywords: ["CREDIT NOTE", "CREDIT MEMO", "CORRECTION", "ADJUSTMENT"]
    PROFORMA:
      keywords: ["PROFORMA", "PRO FORMA", "PRO-FORMA", "QUOTATION"]
    ZALICZKOWA:
      keywords: ["ADVANCE", "DEPOSIT", "PREPAYMENT", "DOWN PAYMENT"]
    KOŃCOWA:
      keywords: ["FINAL", "FINAL INVOICE", "CLOSING"]

# ============================================
# KONFIGURACJA TYPU DOKUMENTU (ORYGINAŁ/KOPIA)
# ============================================
document_type:
  default: "nieznany"
  patterns:
    oryginał:
      - '\bORIGINAL\b'
    kopia:
      - '\bCOPY\b'
      - '\bDUPLICATE COPY\b'
    duplikat:
      - '\bDUPLICATE\b'

# ============================================
# KONFIGURACJA DAT
# ============================================
dates:
  formats:
    # US format
    - pattern: '\d{2}/\d{2}/\d{4}'
      format: '%m/%d/%Y'
    # ISO format
    - pattern: '\d{4}-\d{2}-\d{2}'
      format: '%Y-%m-%d'
    # UK/EU format
    - pattern: '\d{2}\.\d{2}\.\d{4}'
      format: '%d.%m.%Y'
    - pattern: '\d{2}-\d{2}-\d{4}'
      format: '%d-%m-%Y'
    # Written format
    - pattern: '\d{1,2}\s+[A-Za-z]+\s+\d{4}'
      format: '%d %B %Y'
  
  issue_date:
    keywords:
      - "INVOICE DATE"
      - "Invoice Date"
      - "DATE"
      - "Date"
      - "ISSUE DATE"
      - "Issue Date"
      - "DATE OF ISSUE"
      - "Issued"
      - "Dated"
    search_range: 150
    required: true
  
  sale_date:
    keywords:
      - "DELIVERY DATE"
      - "Delivery Date"
      - "SERVICE DATE"
      - "Service Date"
      - "SUPPLY DATE"
      - "Supply Date"
      - "DATE OF SUPPLY"
      - "Ship Date"
    search_range: 150
    fallback: "use_issue_date"
  
  due_date:
    keywords:
      - "DUE DATE"
      - "Due Date"
      - "PAYMENT DUE"
      - "Payment Due"
      - "PAY BY"
      - "Pay By"
      - "TERMS"
      - "Payment Terms"
      - "Net"
    search_range: 150
    fallback_days: 30

# ============================================
# KONFIGURACJA VAT/TAX ID
# ============================================
tax_id:
  name: "VAT/Tax ID"
  patterns:
    - '(?:VAT|TAX)[\s-]?(?:ID|No|Number|Reg)?[:\s]*([A-Z]{2}\s?\d{8,12})'
    - '(?:VAT|TAX)[\s-]?(?:ID|No|Number)?[:\s]*(\d{9,12})'
    - 'EIN[:\s]*(\d{2}-\d{7})'
    - 'Tax\s+ID[:\s]*(\d{9,12})'
    - '\b(GB\s?\d{9})\b'
    - '\b(IE\s?\d{7}[A-Z]{1,2})\b'
  validation:
    type: "vat_eu"
    min_length: 8
    max_length: 14
  prefix: ""

# ============================================
# KONFIGURACJA STRON (SPRZEDAWCA/NABYWCA)
# ============================================
parties:
  seller:
    keywords:
      - "FROM"
      - "From"
      - "SUPPLIER"
      - "Supplier"
      - "VENDOR"
      - "Vendor"
      - "SELLER"
      - "Seller"
      - "SOLD BY"
      - "SHIP FROM"
      - "BILLED BY"
    context_range: 300
  
  buyer:
    keywords:
      - "TO"
      - "To"
      - "BILL TO"
      - "Bill To"
      - "CUSTOMER"
      - "Customer"
      - "BUYER"
      - "Buyer"
      - "CLIENT"
      - "Client"
      - "SHIP TO"
      - "SOLD TO"
      - "INVOICE TO"
    context_range: 300

# ============================================
# KONFIGURACJA ADRESÓW
# ============================================
address:
  patterns:
    # US ZIP
    - '([A-Z]{2}\s+\d{5}(?:-\d{4})?)'
    # UK Postcode
    - '([A-Z]{1,2}\d{1,2}[A-Z]?\s*\d[A-Z]{2})'
    # Generic
    - '(\d+\s+[A-Za-z\s]+(?:Street|St|Avenue|Ave|Road|Rd|Drive|Dr|Lane|Ln|Way|Boulevard|Blvd))'
  postal_code_pattern: '(?:\d{5}(?:-\d{4})?|[A-Z]{1,2}\d{1,2}[A-Z]?\s*\d[A-Z]{2})'
  context_range: 400

# ============================================
# KONFIGURACJA KONT BANKOWYCH
# ============================================
bank_accounts:
  patterns:
    - 'IBAN[:\s]*([A-Z]{2}\d{2}[A-Z0-9\s]+)'
    - 'Account[\s]*(?:No|Number)?[:\s]*(\d{8,17})'
    - 'A/C[:\s]*(\d{8,17})'
    - 'Sort\s*Code[:\s]*(\d{2}-\d{2}-\d{2})'
    - 'Routing[:\s]*(\d{9})'
  iban_prefix: ""
  validation: "iban"

# ============================================
# KONFIGURACJA KWOT
# ============================================
amounts:
  decimal_separator: "."
  thousand_separator: ","
  
  total_gross:
    keywords:
      - "TOTAL"
      - "Total"
      - "AMOUNT DUE"
      - "Amount Due"
      - "TOTAL DUE"
      - "Total Due"
      - "GRAND TOTAL"
      - "Grand Total"
      - "BALANCE DUE"
      - "Balance Due"
      - "INVOICE TOTAL"
      - "TOTAL AMOUNT"
    patterns:
      - '(?:\$|€|£)\s*(\d{1,3}(?:,\d{3})*(?:\.\d{2})?)'
      - '(\d{1,3}(?:,\d{3})*(?:\.\d{2})?)\s*(?:USD|EUR|GBP)'
    required: true
  
  total_net:
    keywords:
      - "SUBTOTAL"
      - "Subtotal"
      - "SUB-TOTAL"
      - "NET"
      - "Net"
      - "NET AMOUNT"
      - "BEFORE TAX"
    fallback: "calculate_from_gross"
    default_vat_rate: 20
  
  total_vat:
    keywords:
      - "VAT"
      - "TAX"
      - "Tax"
      - "SALES TAX"
      - "GST"
      - "HST"
      - "TAX AMOUNT"
    fallback: "calculate_difference"

# ============================================
# KONFIGURACJA PŁATNOŚCI
# ============================================
payment:
  methods:
    przelew:
      keywords: ["BANK TRANSFER", "WIRE TRANSFER", "TRANSFER", "ACH", "BACS"]
    gotówka:
      keywords: ["CASH", "CASH PAYMENT"]
    karta:
      keywords: ["CARD", "CREDIT CARD", "DEBIT CARD", "VISA", "MASTERCARD"]
    check:
      keywords: ["CHECK", "CHEQUE"]
    paypal:
      keywords: ["PAYPAL", "PAY PAL"]
  
  status:
    opłacona:
      keywords: ["PAID", "PAYMENT RECEIVED", "SETTLED", "CLEARED"]
    częściowo_opłacona:
      keywords: ["PARTIAL", "DEPOSIT", "ADVANCE", "PART PAYMENT"]
    nieopłacona:
      keywords: ["DUE", "UNPAID", "OUTSTANDING", "BALANCE DUE", "AMOUNT DUE"]
  
  default_method: "przelew"
  default_status: "nieopłacona"

# ============================================
# KONFIGURACJA POZYCJI FAKTURY
# ============================================
line_items:
  enabled: true
  
  table_start:
    keywords:
      - "ITEM"
      - "Item"
      - "NO"
      - "#"
      - "DESCRIPTION"
      - "Description"
      - "PRODUCT"
    patterns:
      - 'Item|No|#'
      - 'Description.*Qty.*Price'
      - 'Product.*Quantity.*Amount'
  
  table_end:
    keywords:
      - "SUBTOTAL"
      - "Subtotal"
      - "TOTAL"
      - "Total"
      - "TAX"
  
  skip_patterns:
    - 'Page \d+ of \d+'
    - '-{3,}'
    - '={3,}'

# ============================================
# OPCJE PARSOWANIA
# ============================================
options:
  normalize_backslash: true
  remove_extra_whitespace: true
  case_insensitive_keywords: true
  date_tolerance_days: 365
  amount_tolerance: 0.02
  tax_id_assignment_strategy: "context_proximity"
  validate_iban: true
  validate_tax_id: true
  debug_mode: false

# ============================================
# METADANE
# ============================================
metadata:
  author: "System"
  version: "2.0"
  created: "2025-11-29"
  updated: "2025-11-29"